<?xml version="1.0" encoding="UTF-8"?>
<robot generator="Robot 3.2.2 (Python 3.9.9 on darwin)" generated="20220212 11:29:28.919" rpa="false">
<suite id="s1" name="Connector Tests" source="/Users/marthala/mydata/04_Eeneman/src/connector-assemblin/robottests/connectors/assemblin/connector_tests.robot">
<test id="s1-t1" name="fetch, 200">
<kw name="Get Body">
<assign>
<var>${body}</var>
</assign>
<kw name="Copy Dictionary" library="Collections">
<doc>Returns a copy of the given dictionary.</doc>
<arguments>
<arg>${BROKER_BODY}</arg>
<arg>deepcopy=True</arg>
</arguments>
<assign>
<var>${body}</var>
</assign>
<msg timestamp="20220212 11:29:29.108" level="INFO">${body} = {'productCode': 'product-metropolia-assemblin', 'parameters': {'ids': [{'idProperty': 'AI200', 'idRoom': 'A0 PK 12'}], 'dataTypes': ['MeasureAirCO2LevelPPM', 'MeasureAirTemperatureCelsiusDegree', 'Mea...</msg>
<status status="PASS" starttime="20220212 11:29:29.107" endtime="20220212 11:29:29.108"></status>
</kw>
<kw name="Get Current Date" library="DateTime">
<doc>Returns current local or UTC time with an optional increment.</doc>
<arguments>
<arg>time_zone=UTC</arg>
<arg>result_format=%Y-%m-%dT%H:%M:%S+00:00</arg>
</arguments>
<assign>
<var>${now}</var>
</assign>
<msg timestamp="20220212 11:29:29.108" level="INFO">${now} = 2022-02-12T09:29:29+00:00</msg>
<status status="PASS" starttime="20220212 11:29:29.108" endtime="20220212 11:29:29.108"></status>
</kw>
<kw name="Set To Dictionary" library="Collections">
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<arguments>
<arg>${body}</arg>
<arg>timestamp</arg>
<arg>${now}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:29:29.108" endtime="20220212 11:29:29.108"></status>
</kw>
<kw name="Set To Dictionary" library="Collections">
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<arguments>
<arg>${body}</arg>
<arg>&amp;{kwargs}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:29:29.108" endtime="20220212 11:29:29.109"></status>
</kw>
<kw name="Evaluate" library="BuiltIn">
<doc>Evaluates the given expression in Python and returns the result.</doc>
<arguments>
<arg>json.dumps(${body})</arg>
<arg>json</arg>
</arguments>
<assign>
<var>${json_string}</var>
</assign>
<msg timestamp="20220212 11:29:29.109" level="INFO">${json_string} = {"productCode": "product-metropolia-assemblin", "parameters": {"ids": [{"idProperty": "AI200", "idRoom": "A0 PK 12"}], "dataTypes": ["MeasureAirCO2LevelPPM", "MeasureAirTemperatureCelsiusDegree", "Mea...</msg>
<status status="PASS" starttime="20220212 11:29:29.109" endtime="20220212 11:29:29.109"></status>
</kw>
<msg timestamp="20220212 11:29:29.109" level="INFO">${body} = {'productCode': 'product-metropolia-assemblin', 'parameters': {'ids': [{'idProperty': 'AI200', 'idRoom': 'A0 PK 12'}], 'dataTypes': ['MeasureAirCO2LevelPPM', 'MeasureAirTemperatureCelsiusDegree', 'Mea...</msg>
<status status="PASS" starttime="20220212 11:29:29.107" endtime="20220212 11:29:29.109"></status>
</kw>
<kw name="Fetch Data Product">
<arguments>
<arg>${body}</arg>
</arguments>
<kw name="Calculate Pot Signature" library="PoTLib">
<arguments>
<arg>${body}</arg>
<arg>${CLIENT_SECRET}</arg>
</arguments>
<assign>
<var>${signature}</var>
</assign>
<msg timestamp="20220212 11:29:29.110" level="INFO">${signature} = /51UvCRa0BlISfr7gynGykLsdWujgdmyF5IiAgHuFQM=</msg>
<status status="PASS" starttime="20220212 11:29:29.110" endtime="20220212 11:29:29.110"></status>
</kw>
<kw name="Log" library="BuiltIn">
<doc>Logs the given message with the given level.</doc>
<arguments>
<arg>${signature}</arg>
</arguments>
<msg timestamp="20220212 11:29:29.110" level="INFO">/51UvCRa0BlISfr7gynGykLsdWujgdmyF5IiAgHuFQM=</msg>
<status status="PASS" starttime="20220212 11:29:29.110" endtime="20220212 11:29:29.110"></status>
</kw>
<kw name="Set Headers" library="REST">
<tags>
<tag>settings</tag>
</tags>
<doc>*Sets new request headers or updates the existing.*</doc>
<arguments>
<arg>{"x-pot-signature": "${signature}", "x-app-token": "${APP_TOKEN}"}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:29:29.111" endtime="20220212 11:29:29.111"></status>
</kw>
<kw name="Post" library="REST">
<tags>
<tag>http</tag>
</tags>
<doc>*Sends a POST request to the endpoint.*</doc>
<arguments>
<arg>${CONNECTOR_PATH}</arg>
<arg>${body}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:29:29.111" endtime="20220212 11:29:50.555"></status>
</kw>
<kw name="Output Schema" library="REST">
<tags>
<tag>I/O</tag>
</tags>
<doc>*Outputs JSON Schema to terminal or a file.*</doc>
<arguments>
<arg>response body</arg>
</arguments>
<msg timestamp="20220212 11:29:50.556" level="INFO">
{
    "type": "object",
    "properties": {
        "@context": {
            "type": "string",
            "default": "https://standards.oftrust.net/v2/Context/DataProductContext/Sensor/"
        },
        "data": {
            "type": "object",
            "properties": {
                "sensors": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "measurements": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "@type": {
                                            "type": "string"
                                        },
                                        "timestamp": {
                                            "type": "string"
                                        },
                                        "value": {
                                            "type": "string"
                                        }
                                    },
                                    "required": [
                                        "@type",
                                        "timestamp",
                                        "value"
                                    ]
                                }
                            },
                            "id": {
                                "type": "object",
                                "properties": {
                                    "idRoom": {
                                        "type": "string"
                                    },
                                    "idProperty": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "idProperty",
                                    "idRoom"
                                ]
                            }
                        },
                        "required": [
                            "id",
                            "measurements"
                        ]
                    },
                    "default": [
                        {
                            "measurements": [
                                {
                                    "@type": "MeasureElectricityConsumptionKilowattHour",
                                    "timestamp": "2022-02-12T09:29:50+00:00",
                                    "value": "498139136.000000"
                                }
                            ],
                            "id": {
                                "idRoom": "A0 PK 12",
                                "idProperty": "AI200"
                            }
                        }
                    ]
                }
            },
            "required": [
                "sensors"
            ]
        },
        "signature": {
            "type": "object",
            "properties": {
                "type": {
                    "type": "string",
                    "default": "RsaSignature2018"
                },
                "created": {
                    "type": "string",
                    "default": "2022-02-12T11:29:50+02:00"
                },
                "creator": {
                    "type": "string",
                    "default": "https://localhost:8080/assemblin/translator/v1/public.key"
                },
                "signatureValue": {
                    "type": "string",
                    "default": "UOBriFyofLgvuK7NW3kT0jLIdI5FEzATM0m/L0Xovv4d0QeTCJgcrlEeoOuet6PWQgjfdKx47mBI0igra7jwbnQ3XxMkhACKGkKvNalC6zKVaDnO5CBYbu7fpiq8hgWZwY7O0i+/DPBobXDMPr5cINxejOhtE+2Osdtqx8+g5sNeOTUM7/bBBNV+2rD1XspPw4tT8g2XJLdqC2fD7Lncso8g3YK9NEwTjahbzg52QznyYFaGyPrSZNQqOher86tj+HOdpJNUOynJwnjTvwfFcCuz7UyoAMXoqzk7UAeuwkvupPJsdz3uTZ5yBRGRqzJO9ASCKmg9kEQeMgasLDUbfpRHUcGm/SSMUpncE1ycg0sPGMW52TppgQ2nRaxi4M8VZmlRXuzCjoLK0EOCtHZ8qYLeTmapYS0nCJS/iONQdJw6MUL/KLvlVTbxzi+pz/ZmzsD8ytdquR+SZBuATgHfuFY+1nnmSC+sPPx2zh5oNOEwof0RWCiPAMEG4NhrUZP3OL00JqMUQoBicBb7SbUEWf6IFgo9mBAT/lVfJHiGU2+k18W6rKHFMdJtjfPZw3NPUdz+gkiv64rsW08rgyA1zl/sByzJjwbGdUHsllT7pt9vLUQQd2ZM2DdecbrAjeF14om9W2rp4fA4Q9lbs2EUQKayiCl7U5rjxvs9XL86CWo="
                }
            },
            "required": [
                "created",
                "creator",
                "signatureValue",
                "type"
            ]
        }
    },
    "required": [
        "@context",
        "data",
        "signature"
    ]
}</msg>
<status status="PASS" starttime="20220212 11:29:50.555" endtime="20220212 11:29:50.564"></status>
</kw>
<status status="PASS" starttime="20220212 11:29:29.109" endtime="20220212 11:29:50.564"></status>
</kw>
<kw name="Integer" library="REST">
<tags>
<tag>assertions</tag>
</tags>
<doc>*Asserts the field as JSON integer.*</doc>
<arguments>
<arg>response status</arg>
<arg>200</arg>
</arguments>
<status status="PASS" starttime="20220212 11:29:50.564" endtime="20220212 11:29:50.565"></status>
</kw>
<kw name="String" library="REST">
<tags>
<tag>assertions</tag>
</tags>
<doc>*Asserts the field as JSON string.*</doc>
<arguments>
<arg>response body @context</arg>
<arg>https://standards.oftrust.net/v2/Context/DataProductContext/Sensor/</arg>
</arguments>
<status status="PASS" starttime="20220212 11:29:50.565" endtime="20220212 11:29:50.565"></status>
</kw>
<kw name="Object" library="REST">
<tags>
<tag>assertions</tag>
</tags>
<doc>*Asserts the field as JSON object.*</doc>
<arguments>
<arg>response body data</arg>
</arguments>
<status status="PASS" starttime="20220212 11:29:50.565" endtime="20220212 11:29:50.577"></status>
</kw>
<kw name="Array" library="REST">
<tags>
<tag>assertions</tag>
</tags>
<doc>*Asserts the field as JSON array.*</doc>
<arguments>
<arg>response body data sensors</arg>
</arguments>
<status status="PASS" starttime="20220212 11:29:50.577" endtime="20220212 11:29:50.578"></status>
</kw>
<kw name="Array" library="REST">
<tags>
<tag>assertions</tag>
</tags>
<doc>*Asserts the field as JSON array.*</doc>
<arguments>
<arg>response body data sensors 0 measurements</arg>
</arguments>
<status status="PASS" starttime="20220212 11:29:50.578" endtime="20220212 11:29:50.579"></status>
</kw>
<kw name="Object" library="REST">
<tags>
<tag>assertions</tag>
</tags>
<doc>*Asserts the field as JSON object.*</doc>
<arguments>
<arg>response body data sensors 0 id</arg>
</arguments>
<status status="PASS" starttime="20220212 11:29:50.579" endtime="20220212 11:29:50.579"></status>
</kw>
<tags>
<tag>bug-0001</tag>
</tags>
<status status="PASS" starttime="20220212 11:29:29.106" endtime="20220212 11:29:50.580" critical="yes"></status>
</test>
<test id="s1-t2" name="fetch, 422, Missing data for timestamp required field">
<kw name="Get Body">
<assign>
<var>${body}</var>
</assign>
<kw name="Copy Dictionary" library="Collections">
<doc>Returns a copy of the given dictionary.</doc>
<arguments>
<arg>${BROKER_BODY}</arg>
<arg>deepcopy=True</arg>
</arguments>
<assign>
<var>${body}</var>
</assign>
<msg timestamp="20220212 11:29:50.581" level="INFO">${body} = {'productCode': 'product-metropolia-assemblin', 'parameters': {'ids': [{'idProperty': 'AI200', 'idRoom': 'A0 PK 12'}], 'dataTypes': ['MeasureAirCO2LevelPPM', 'MeasureAirTemperatureCelsiusDegree', 'Mea...</msg>
<status status="PASS" starttime="20220212 11:29:50.580" endtime="20220212 11:29:50.581"></status>
</kw>
<kw name="Get Current Date" library="DateTime">
<doc>Returns current local or UTC time with an optional increment.</doc>
<arguments>
<arg>time_zone=UTC</arg>
<arg>result_format=%Y-%m-%dT%H:%M:%S+00:00</arg>
</arguments>
<assign>
<var>${now}</var>
</assign>
<msg timestamp="20220212 11:29:50.581" level="INFO">${now} = 2022-02-12T09:29:50+00:00</msg>
<status status="PASS" starttime="20220212 11:29:50.581" endtime="20220212 11:29:50.581"></status>
</kw>
<kw name="Set To Dictionary" library="Collections">
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<arguments>
<arg>${body}</arg>
<arg>timestamp</arg>
<arg>${now}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:29:50.581" endtime="20220212 11:29:50.581"></status>
</kw>
<kw name="Set To Dictionary" library="Collections">
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<arguments>
<arg>${body}</arg>
<arg>&amp;{kwargs}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:29:50.581" endtime="20220212 11:29:50.582"></status>
</kw>
<kw name="Evaluate" library="BuiltIn">
<doc>Evaluates the given expression in Python and returns the result.</doc>
<arguments>
<arg>json.dumps(${body})</arg>
<arg>json</arg>
</arguments>
<assign>
<var>${json_string}</var>
</assign>
<msg timestamp="20220212 11:29:50.582" level="INFO">${json_string} = {"productCode": "product-metropolia-assemblin", "parameters": {"ids": [{"idProperty": "AI200", "idRoom": "A0 PK 12"}], "dataTypes": ["MeasureAirCO2LevelPPM", "MeasureAirTemperatureCelsiusDegree", "Mea...</msg>
<status status="PASS" starttime="20220212 11:29:50.582" endtime="20220212 11:29:50.582"></status>
</kw>
<msg timestamp="20220212 11:29:50.582" level="INFO">${body} = {'productCode': 'product-metropolia-assemblin', 'parameters': {'ids': [{'idProperty': 'AI200', 'idRoom': 'A0 PK 12'}], 'dataTypes': ['MeasureAirCO2LevelPPM', 'MeasureAirTemperatureCelsiusDegree', 'Mea...</msg>
<status status="PASS" starttime="20220212 11:29:50.580" endtime="20220212 11:29:50.582"></status>
</kw>
<kw name="Pop From Dictionary" library="Collections">
<doc>Pops the given ``key`` from the ``dictionary`` and returns its value.</doc>
<arguments>
<arg>${body}</arg>
<arg>timestamp</arg>
</arguments>
<status status="PASS" starttime="20220212 11:29:50.582" endtime="20220212 11:29:50.582"></status>
</kw>
<kw name="Fetch Data Product">
<arguments>
<arg>${body}</arg>
</arguments>
<kw name="Calculate Pot Signature" library="PoTLib">
<arguments>
<arg>${body}</arg>
<arg>${CLIENT_SECRET}</arg>
</arguments>
<assign>
<var>${signature}</var>
</assign>
<msg timestamp="20220212 11:29:50.583" level="INFO">${signature} = MQ/UyCncHOMiQcqCy8xCRj/2MZE9XU4pSgo2sZvCJII=</msg>
<status status="PASS" starttime="20220212 11:29:50.583" endtime="20220212 11:29:50.583"></status>
</kw>
<kw name="Log" library="BuiltIn">
<doc>Logs the given message with the given level.</doc>
<arguments>
<arg>${signature}</arg>
</arguments>
<msg timestamp="20220212 11:29:50.583" level="INFO">MQ/UyCncHOMiQcqCy8xCRj/2MZE9XU4pSgo2sZvCJII=</msg>
<status status="PASS" starttime="20220212 11:29:50.583" endtime="20220212 11:29:50.583"></status>
</kw>
<kw name="Set Headers" library="REST">
<tags>
<tag>settings</tag>
</tags>
<doc>*Sets new request headers or updates the existing.*</doc>
<arguments>
<arg>{"x-pot-signature": "${signature}", "x-app-token": "${APP_TOKEN}"}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:29:50.583" endtime="20220212 11:29:50.584"></status>
</kw>
<kw name="Post" library="REST">
<tags>
<tag>http</tag>
</tags>
<doc>*Sends a POST request to the endpoint.*</doc>
<arguments>
<arg>${CONNECTOR_PATH}</arg>
<arg>${body}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:29:50.584" endtime="20220212 11:30:11.940"></status>
</kw>
<kw name="Output Schema" library="REST">
<tags>
<tag>I/O</tag>
</tags>
<doc>*Outputs JSON Schema to terminal or a file.*</doc>
<arguments>
<arg>response body</arg>
</arguments>
<msg timestamp="20220212 11:30:11.941" level="INFO">
{
    "type": "object",
    "properties": {
        "@context": {
            "type": "string",
            "default": "https://standards.oftrust.net/v2/Context/DataProductContext/Sensor/"
        },
        "data": {
            "type": "object",
            "properties": {
                "sensors": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "measurements": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "@type": {
                                            "type": "string"
                                        },
                                        "timestamp": {
                                            "type": "string"
                                        },
                                        "value": {
                                            "type": "string"
                                        }
                                    },
                                    "required": [
                                        "@type",
                                        "timestamp",
                                        "value"
                                    ]
                                }
                            },
                            "id": {
                                "type": "object",
                                "properties": {
                                    "idRoom": {
                                        "type": "string"
                                    },
                                    "idProperty": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "idProperty",
                                    "idRoom"
                                ]
                            }
                        },
                        "required": [
                            "id",
                            "measurements"
                        ]
                    },
                    "default": [
                        {
                            "measurements": [
                                {
                                    "@type": "MeasureElectricityConsumptionKilowattHour",
                                    "timestamp": "2022-02-12T09:30:11+00:00",
                                    "value": "498139136.000000"
                                }
                            ],
                            "id": {
                                "idRoom": "A0 PK 12",
                                "idProperty": "AI200"
                            }
                        }
                    ]
                }
            },
            "required": [
                "sensors"
            ]
        },
        "signature": {
            "type": "object",
            "properties": {
                "type": {
                    "type": "string",
                    "default": "RsaSignature2018"
                },
                "created": {
                    "type": "string",
                    "default": "2022-02-12T11:30:11+02:00"
                },
                "creator": {
                    "type": "string",
                    "default": "https://localhost:8080/assemblin/translator/v1/public.key"
                },
                "signatureValue": {
                    "type": "string",
                    "default": "BwhxL3I0rSEyWPkUI9WW0RKOCrIeRHKInbSFtH8UdMODxMexYtcARsxZVIvBtGDXmXDtHM9hNN/dzyZRg5n8KQ9gfqyci0b5yJFjQ9E5KwYw+LaY+hLKPzEoDOEX2PDWRTMC6N4M9F16n2CVRX+0mRMhv0IauVyG2IWTYMiudXP3WWzETyK4xsyzwDsXELsbXGt3nY9UAJBt+8YpPF/N166azsSD0to//o8b1ytJk2rAvU5IbcjgIc/+LbrN0evg1fxeQjZuPA0Ku4364JbAgLsYWiLAG0yOmXv4BqcqNWycohqX0uQLsVRk1vnhIN728zQ2UcoKCTC1VEtvB/80GRSsu/ZqWZcucENTWuA4ZBFgO954/q6s6rL07abunLsdErJ69NACtyHKzyh11Y7sIr3Uo1/09j21JO/0Aqbfx3mFwCC6KmcpxFztkYvWIbH3hZKKSfmkPRLuq+dNh+W2skx7mcZgBUKMWjDYQ0ef+8VHS7yZopTkhE270SUxjsjKXC6oT3WW4FBHZC9Xmx2qWRQwGGoYtnjWttPX+xnfzJmxHqKZm/LDXZrfgZiudZlvimdTase2nR9W2icGFWU9gUTSoAu3H0O0dokcTL5bTVVtQ2eRj2RL5KdMSc8A3I75+h0yxDJ6YVtZu3CF6tNenf/BpwgZrJzYTL/ISl9aCpE="
                }
            },
            "required": [
                "created",
                "creator",
                "signatureValue",
                "type"
            ]
        }
    },
    "required": [
        "@context",
        "data",
        "signature"
    ]
}</msg>
<status status="PASS" starttime="20220212 11:30:11.940" endtime="20220212 11:30:11.943"></status>
</kw>
<status status="PASS" starttime="20220212 11:29:50.582" endtime="20220212 11:30:11.943"></status>
</kw>
<kw name="Integer" library="REST">
<tags>
<tag>assertions</tag>
</tags>
<doc>*Asserts the field as JSON integer.*</doc>
<arguments>
<arg>response status</arg>
<arg>422</arg>
</arguments>
<msg timestamp="20220212 11:30:11.944" level="FAIL">200 is not one of [422]

Failed validating 'enum' in schema:
    {'enum': [422], 'type': 'integer'}

On instance:
    200</msg>
<status status="FAIL" starttime="20220212 11:30:11.943" endtime="20220212 11:30:11.945"></status>
</kw>
<tags>
<tag>bug-0001</tag>
</tags>
<status status="FAIL" starttime="20220212 11:29:50.580" endtime="20220212 11:30:11.945" critical="yes">200 is not one of [422]

Failed validating 'enum' in schema:
    {'enum': [422], 'type': 'integer'}

On instance:
    200</status>
</test>
<test id="s1-t3" name="fetch, 422, Missing data for parameters required field">
<kw name="Get Body">
<assign>
<var>${body}</var>
</assign>
<kw name="Copy Dictionary" library="Collections">
<doc>Returns a copy of the given dictionary.</doc>
<arguments>
<arg>${BROKER_BODY}</arg>
<arg>deepcopy=True</arg>
</arguments>
<assign>
<var>${body}</var>
</assign>
<msg timestamp="20220212 11:30:11.946" level="INFO">${body} = {'productCode': 'product-metropolia-assemblin', 'parameters': {'ids': [{'idProperty': 'AI200', 'idRoom': 'A0 PK 12'}], 'dataTypes': ['MeasureAirCO2LevelPPM', 'MeasureAirTemperatureCelsiusDegree', 'Mea...</msg>
<status status="PASS" starttime="20220212 11:30:11.946" endtime="20220212 11:30:11.946"></status>
</kw>
<kw name="Get Current Date" library="DateTime">
<doc>Returns current local or UTC time with an optional increment.</doc>
<arguments>
<arg>time_zone=UTC</arg>
<arg>result_format=%Y-%m-%dT%H:%M:%S+00:00</arg>
</arguments>
<assign>
<var>${now}</var>
</assign>
<msg timestamp="20220212 11:30:11.946" level="INFO">${now} = 2022-02-12T09:30:11+00:00</msg>
<status status="PASS" starttime="20220212 11:30:11.946" endtime="20220212 11:30:11.947"></status>
</kw>
<kw name="Set To Dictionary" library="Collections">
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<arguments>
<arg>${body}</arg>
<arg>timestamp</arg>
<arg>${now}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.947" endtime="20220212 11:30:11.947"></status>
</kw>
<kw name="Set To Dictionary" library="Collections">
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<arguments>
<arg>${body}</arg>
<arg>&amp;{kwargs}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.947" endtime="20220212 11:30:11.947"></status>
</kw>
<kw name="Evaluate" library="BuiltIn">
<doc>Evaluates the given expression in Python and returns the result.</doc>
<arguments>
<arg>json.dumps(${body})</arg>
<arg>json</arg>
</arguments>
<assign>
<var>${json_string}</var>
</assign>
<msg timestamp="20220212 11:30:11.948" level="INFO">${json_string} = {"productCode": "product-metropolia-assemblin", "parameters": {"ids": [{"idProperty": "AI200", "idRoom": "A0 PK 12"}], "dataTypes": ["MeasureAirCO2LevelPPM", "MeasureAirTemperatureCelsiusDegree", "Mea...</msg>
<status status="PASS" starttime="20220212 11:30:11.947" endtime="20220212 11:30:11.948"></status>
</kw>
<msg timestamp="20220212 11:30:11.948" level="INFO">${body} = {'productCode': 'product-metropolia-assemblin', 'parameters': {'ids': [{'idProperty': 'AI200', 'idRoom': 'A0 PK 12'}], 'dataTypes': ['MeasureAirCO2LevelPPM', 'MeasureAirTemperatureCelsiusDegree', 'Mea...</msg>
<status status="PASS" starttime="20220212 11:30:11.945" endtime="20220212 11:30:11.948"></status>
</kw>
<kw name="Pop From Dictionary" library="Collections">
<doc>Pops the given ``key`` from the ``dictionary`` and returns its value.</doc>
<arguments>
<arg>${body}</arg>
<arg>parameters</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.948" endtime="20220212 11:30:11.948"></status>
</kw>
<kw name="Fetch Data Product">
<arguments>
<arg>${body}</arg>
</arguments>
<kw name="Calculate Pot Signature" library="PoTLib">
<arguments>
<arg>${body}</arg>
<arg>${CLIENT_SECRET}</arg>
</arguments>
<assign>
<var>${signature}</var>
</assign>
<msg timestamp="20220212 11:30:11.949" level="INFO">${signature} = kezL2mcxqaAag1MLzOSAmY8HfIREUJpSecbz5M0F0rk=</msg>
<status status="PASS" starttime="20220212 11:30:11.949" endtime="20220212 11:30:11.949"></status>
</kw>
<kw name="Log" library="BuiltIn">
<doc>Logs the given message with the given level.</doc>
<arguments>
<arg>${signature}</arg>
</arguments>
<msg timestamp="20220212 11:30:11.949" level="INFO">kezL2mcxqaAag1MLzOSAmY8HfIREUJpSecbz5M0F0rk=</msg>
<status status="PASS" starttime="20220212 11:30:11.949" endtime="20220212 11:30:11.949"></status>
</kw>
<kw name="Set Headers" library="REST">
<tags>
<tag>settings</tag>
</tags>
<doc>*Sets new request headers or updates the existing.*</doc>
<arguments>
<arg>{"x-pot-signature": "${signature}", "x-app-token": "${APP_TOKEN}"}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.949" endtime="20220212 11:30:11.949"></status>
</kw>
<kw name="Post" library="REST">
<tags>
<tag>http</tag>
</tags>
<doc>*Sends a POST request to the endpoint.*</doc>
<arguments>
<arg>${CONNECTOR_PATH}</arg>
<arg>${body}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.949" endtime="20220212 11:30:11.954"></status>
</kw>
<kw name="Output Schema" library="REST">
<tags>
<tag>I/O</tag>
</tags>
<doc>*Outputs JSON Schema to terminal or a file.*</doc>
<arguments>
<arg>response body</arg>
</arguments>
<msg timestamp="20220212 11:30:11.954" level="INFO">
{
    "type": "object",
    "properties": {
        "error": {
            "type": "object",
            "properties": {
                "status": {
                    "type": "integer",
                    "default": 422
                },
                "message": {
                    "type": "object",
                    "properties": {
                        "parameters": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            },
                            "default": [
                                "Missing data for required field."
                            ]
                        },
                        "parameters.ids": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            },
                            "default": [
                                "Missing data for required field."
                            ]
                        },
                        "parameters.ids[0].idRoom": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            },
                            "default": [
                                "Missing data for required field."
                            ]
                        },
                        "parameters.ids[0].idProperty": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            },
                            "default": [
                                "Missing data for required field."
                            ]
                        },
                        "parameters.dataTypes": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            },
                            "default": [
                                "Missing data for required field."
                            ]
                        }
                    },
                    "required": [
                        "parameters",
                        "parameters.dataTypes",
                        "parameters.ids",
                        "parameters.ids[0].idProperty",
                        "parameters.ids[0].idRoom"
                    ]
                }
            },
            "required": [
                "message",
                "status"
            ]
        }
    },
    "required": [
        "error"
    ]
}</msg>
<status status="PASS" starttime="20220212 11:30:11.954" endtime="20220212 11:30:11.956"></status>
</kw>
<status status="PASS" starttime="20220212 11:30:11.948" endtime="20220212 11:30:11.956"></status>
</kw>
<kw name="Integer" library="REST">
<tags>
<tag>assertions</tag>
</tags>
<doc>*Asserts the field as JSON integer.*</doc>
<arguments>
<arg>response status</arg>
<arg>502</arg>
</arguments>
<msg timestamp="20220212 11:30:11.957" level="FAIL">422 is not one of [502]

Failed validating 'enum' in schema:
    {'enum': [502], 'type': 'integer'}

On instance:
    422</msg>
<status status="FAIL" starttime="20220212 11:30:11.957" endtime="20220212 11:30:11.957"></status>
</kw>
<tags>
<tag>bug-0002</tag>
</tags>
<status status="FAIL" starttime="20220212 11:30:11.945" endtime="20220212 11:30:11.958" critical="yes">422 is not one of [502]

Failed validating 'enum' in schema:
    {'enum': [502], 'type': 'integer'}

On instance:
    422</status>
</test>
<test id="s1-t4" name="fetch, 422, Missing data for ids required field">
<kw name="Get Body">
<assign>
<var>${body}</var>
</assign>
<kw name="Copy Dictionary" library="Collections">
<doc>Returns a copy of the given dictionary.</doc>
<arguments>
<arg>${BROKER_BODY}</arg>
<arg>deepcopy=True</arg>
</arguments>
<assign>
<var>${body}</var>
</assign>
<msg timestamp="20220212 11:30:11.959" level="INFO">${body} = {'productCode': 'product-metropolia-assemblin', 'parameters': {'ids': [{'idProperty': 'AI200', 'idRoom': 'A0 PK 12'}], 'dataTypes': ['MeasureAirCO2LevelPPM', 'MeasureAirTemperatureCelsiusDegree', 'Mea...</msg>
<status status="PASS" starttime="20220212 11:30:11.959" endtime="20220212 11:30:11.959"></status>
</kw>
<kw name="Get Current Date" library="DateTime">
<doc>Returns current local or UTC time with an optional increment.</doc>
<arguments>
<arg>time_zone=UTC</arg>
<arg>result_format=%Y-%m-%dT%H:%M:%S+00:00</arg>
</arguments>
<assign>
<var>${now}</var>
</assign>
<msg timestamp="20220212 11:30:11.959" level="INFO">${now} = 2022-02-12T09:30:11+00:00</msg>
<status status="PASS" starttime="20220212 11:30:11.959" endtime="20220212 11:30:11.960"></status>
</kw>
<kw name="Set To Dictionary" library="Collections">
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<arguments>
<arg>${body}</arg>
<arg>timestamp</arg>
<arg>${now}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.960" endtime="20220212 11:30:11.960"></status>
</kw>
<kw name="Set To Dictionary" library="Collections">
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<arguments>
<arg>${body}</arg>
<arg>&amp;{kwargs}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.960" endtime="20220212 11:30:11.960"></status>
</kw>
<kw name="Evaluate" library="BuiltIn">
<doc>Evaluates the given expression in Python and returns the result.</doc>
<arguments>
<arg>json.dumps(${body})</arg>
<arg>json</arg>
</arguments>
<assign>
<var>${json_string}</var>
</assign>
<msg timestamp="20220212 11:30:11.961" level="INFO">${json_string} = {"productCode": "product-metropolia-assemblin", "parameters": {"ids": [{"idProperty": "AI200", "idRoom": "A0 PK 12"}], "dataTypes": ["MeasureAirCO2LevelPPM", "MeasureAirTemperatureCelsiusDegree", "Mea...</msg>
<status status="PASS" starttime="20220212 11:30:11.960" endtime="20220212 11:30:11.961"></status>
</kw>
<msg timestamp="20220212 11:30:11.961" level="INFO">${body} = {'productCode': 'product-metropolia-assemblin', 'parameters': {'ids': [{'idProperty': 'AI200', 'idRoom': 'A0 PK 12'}], 'dataTypes': ['MeasureAirCO2LevelPPM', 'MeasureAirTemperatureCelsiusDegree', 'Mea...</msg>
<status status="PASS" starttime="20220212 11:30:11.958" endtime="20220212 11:30:11.961"></status>
</kw>
<kw name="Pop From Dictionary" library="Collections">
<doc>Pops the given ``key`` from the ``dictionary`` and returns its value.</doc>
<arguments>
<arg>${body["parameters"]}</arg>
<arg>ids</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.961" endtime="20220212 11:30:11.961"></status>
</kw>
<kw name="Fetch Data Product">
<arguments>
<arg>${body}</arg>
</arguments>
<kw name="Calculate Pot Signature" library="PoTLib">
<arguments>
<arg>${body}</arg>
<arg>${CLIENT_SECRET}</arg>
</arguments>
<assign>
<var>${signature}</var>
</assign>
<msg timestamp="20220212 11:30:11.962" level="INFO">${signature} = 3n6C7wJhhvr/AQQGudsVp+TrCXdbMwZXwnFxrCIAHzU=</msg>
<status status="PASS" starttime="20220212 11:30:11.962" endtime="20220212 11:30:11.962"></status>
</kw>
<kw name="Log" library="BuiltIn">
<doc>Logs the given message with the given level.</doc>
<arguments>
<arg>${signature}</arg>
</arguments>
<msg timestamp="20220212 11:30:11.962" level="INFO">3n6C7wJhhvr/AQQGudsVp+TrCXdbMwZXwnFxrCIAHzU=</msg>
<status status="PASS" starttime="20220212 11:30:11.962" endtime="20220212 11:30:11.962"></status>
</kw>
<kw name="Set Headers" library="REST">
<tags>
<tag>settings</tag>
</tags>
<doc>*Sets new request headers or updates the existing.*</doc>
<arguments>
<arg>{"x-pot-signature": "${signature}", "x-app-token": "${APP_TOKEN}"}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.962" endtime="20220212 11:30:11.962"></status>
</kw>
<kw name="Post" library="REST">
<tags>
<tag>http</tag>
</tags>
<doc>*Sends a POST request to the endpoint.*</doc>
<arguments>
<arg>${CONNECTOR_PATH}</arg>
<arg>${body}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.962" endtime="20220212 11:30:11.968"></status>
</kw>
<kw name="Output Schema" library="REST">
<tags>
<tag>I/O</tag>
</tags>
<doc>*Outputs JSON Schema to terminal or a file.*</doc>
<arguments>
<arg>response body</arg>
</arguments>
<msg timestamp="20220212 11:30:11.968" level="INFO">
{
    "type": "object",
    "properties": {
        "error": {
            "type": "object",
            "properties": {
                "status": {
                    "type": "integer",
                    "default": 422
                },
                "message": {
                    "type": "object",
                    "properties": {
                        "parameters.ids": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            },
                            "default": [
                                "Missing data for required field."
                            ]
                        },
                        "parameters.ids[0].idRoom": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            },
                            "default": [
                                "Missing data for required field."
                            ]
                        },
                        "parameters.ids[0].idProperty": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            },
                            "default": [
                                "Missing data for required field."
                            ]
                        }
                    },
                    "required": [
                        "parameters.ids",
                        "parameters.ids[0].idProperty",
                        "parameters.ids[0].idRoom"
                    ]
                }
            },
            "required": [
                "message",
                "status"
            ]
        }
    },
    "required": [
        "error"
    ]
}</msg>
<status status="PASS" starttime="20220212 11:30:11.968" endtime="20220212 11:30:11.969"></status>
</kw>
<status status="PASS" starttime="20220212 11:30:11.961" endtime="20220212 11:30:11.969"></status>
</kw>
<kw name="Integer" library="REST">
<tags>
<tag>assertions</tag>
</tags>
<doc>*Asserts the field as JSON integer.*</doc>
<arguments>
<arg>response status</arg>
<arg>502</arg>
</arguments>
<msg timestamp="20220212 11:30:11.970" level="FAIL">422 is not one of [502]

Failed validating 'enum' in schema:
    {'enum': [502], 'type': 'integer'}

On instance:
    422</msg>
<status status="FAIL" starttime="20220212 11:30:11.969" endtime="20220212 11:30:11.970"></status>
</kw>
<tags>
<tag>bug-0003</tag>
</tags>
<status status="FAIL" starttime="20220212 11:30:11.958" endtime="20220212 11:30:11.971" critical="yes">422 is not one of [502]

Failed validating 'enum' in schema:
    {'enum': [502], 'type': 'integer'}

On instance:
    422</status>
</test>
<test id="s1-t5" name="fetch, 422, Missing data for dataTypes required field">
<kw name="Get Body">
<assign>
<var>${body}</var>
</assign>
<kw name="Copy Dictionary" library="Collections">
<doc>Returns a copy of the given dictionary.</doc>
<arguments>
<arg>${BROKER_BODY}</arg>
<arg>deepcopy=True</arg>
</arguments>
<assign>
<var>${body}</var>
</assign>
<msg timestamp="20220212 11:30:11.972" level="INFO">${body} = {'productCode': 'product-metropolia-assemblin', 'parameters': {'ids': [{'idProperty': 'AI200', 'idRoom': 'A0 PK 12'}], 'dataTypes': ['MeasureAirCO2LevelPPM', 'MeasureAirTemperatureCelsiusDegree', 'Mea...</msg>
<status status="PASS" starttime="20220212 11:30:11.972" endtime="20220212 11:30:11.972"></status>
</kw>
<kw name="Get Current Date" library="DateTime">
<doc>Returns current local or UTC time with an optional increment.</doc>
<arguments>
<arg>time_zone=UTC</arg>
<arg>result_format=%Y-%m-%dT%H:%M:%S+00:00</arg>
</arguments>
<assign>
<var>${now}</var>
</assign>
<msg timestamp="20220212 11:30:11.973" level="INFO">${now} = 2022-02-12T09:30:11+00:00</msg>
<status status="PASS" starttime="20220212 11:30:11.972" endtime="20220212 11:30:11.973"></status>
</kw>
<kw name="Set To Dictionary" library="Collections">
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<arguments>
<arg>${body}</arg>
<arg>timestamp</arg>
<arg>${now}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.973" endtime="20220212 11:30:11.973"></status>
</kw>
<kw name="Set To Dictionary" library="Collections">
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<arguments>
<arg>${body}</arg>
<arg>&amp;{kwargs}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.973" endtime="20220212 11:30:11.974"></status>
</kw>
<kw name="Evaluate" library="BuiltIn">
<doc>Evaluates the given expression in Python and returns the result.</doc>
<arguments>
<arg>json.dumps(${body})</arg>
<arg>json</arg>
</arguments>
<assign>
<var>${json_string}</var>
</assign>
<msg timestamp="20220212 11:30:11.974" level="INFO">${json_string} = {"productCode": "product-metropolia-assemblin", "parameters": {"ids": [{"idProperty": "AI200", "idRoom": "A0 PK 12"}], "dataTypes": ["MeasureAirCO2LevelPPM", "MeasureAirTemperatureCelsiusDegree", "Mea...</msg>
<status status="PASS" starttime="20220212 11:30:11.974" endtime="20220212 11:30:11.974"></status>
</kw>
<msg timestamp="20220212 11:30:11.975" level="INFO">${body} = {'productCode': 'product-metropolia-assemblin', 'parameters': {'ids': [{'idProperty': 'AI200', 'idRoom': 'A0 PK 12'}], 'dataTypes': ['MeasureAirCO2LevelPPM', 'MeasureAirTemperatureCelsiusDegree', 'Mea...</msg>
<status status="PASS" starttime="20220212 11:30:11.972" endtime="20220212 11:30:11.975"></status>
</kw>
<kw name="Pop From Dictionary" library="Collections">
<doc>Pops the given ``key`` from the ``dictionary`` and returns its value.</doc>
<arguments>
<arg>${body["parameters"]}</arg>
<arg>dataTypes</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.975" endtime="20220212 11:30:11.975"></status>
</kw>
<kw name="Fetch Data Product">
<arguments>
<arg>${body}</arg>
</arguments>
<kw name="Calculate Pot Signature" library="PoTLib">
<arguments>
<arg>${body}</arg>
<arg>${CLIENT_SECRET}</arg>
</arguments>
<assign>
<var>${signature}</var>
</assign>
<msg timestamp="20220212 11:30:11.976" level="INFO">${signature} = DbxpcA0hz+K2f0l0ubf9nz+VGotqpkNX3QleVeQv5S8=</msg>
<status status="PASS" starttime="20220212 11:30:11.975" endtime="20220212 11:30:11.976"></status>
</kw>
<kw name="Log" library="BuiltIn">
<doc>Logs the given message with the given level.</doc>
<arguments>
<arg>${signature}</arg>
</arguments>
<msg timestamp="20220212 11:30:11.976" level="INFO">DbxpcA0hz+K2f0l0ubf9nz+VGotqpkNX3QleVeQv5S8=</msg>
<status status="PASS" starttime="20220212 11:30:11.976" endtime="20220212 11:30:11.976"></status>
</kw>
<kw name="Set Headers" library="REST">
<tags>
<tag>settings</tag>
</tags>
<doc>*Sets new request headers or updates the existing.*</doc>
<arguments>
<arg>{"x-pot-signature": "${signature}", "x-app-token": "${APP_TOKEN}"}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.976" endtime="20220212 11:30:11.976"></status>
</kw>
<kw name="Post" library="REST">
<tags>
<tag>http</tag>
</tags>
<doc>*Sends a POST request to the endpoint.*</doc>
<arguments>
<arg>${CONNECTOR_PATH}</arg>
<arg>${body}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.976" endtime="20220212 11:30:11.981"></status>
</kw>
<kw name="Output Schema" library="REST">
<tags>
<tag>I/O</tag>
</tags>
<doc>*Outputs JSON Schema to terminal or a file.*</doc>
<arguments>
<arg>response body</arg>
</arguments>
<msg timestamp="20220212 11:30:11.981" level="INFO">
{
    "type": "object",
    "properties": {
        "error": {
            "type": "object",
            "properties": {
                "status": {
                    "type": "integer",
                    "default": 422
                },
                "message": {
                    "type": "object",
                    "properties": {
                        "parameters.dataTypes": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            },
                            "default": [
                                "Missing data for required field."
                            ]
                        }
                    },
                    "required": [
                        "parameters.dataTypes"
                    ]
                }
            },
            "required": [
                "message",
                "status"
            ]
        }
    },
    "required": [
        "error"
    ]
}</msg>
<status status="PASS" starttime="20220212 11:30:11.981" endtime="20220212 11:30:11.982"></status>
</kw>
<status status="PASS" starttime="20220212 11:30:11.975" endtime="20220212 11:30:11.982"></status>
</kw>
<kw name="Integer" library="REST">
<tags>
<tag>assertions</tag>
</tags>
<doc>*Asserts the field as JSON integer.*</doc>
<arguments>
<arg>response status</arg>
<arg>502</arg>
</arguments>
<msg timestamp="20220212 11:30:11.983" level="FAIL">422 is not one of [502]

Failed validating 'enum' in schema:
    {'enum': [502], 'type': 'integer'}

On instance:
    422</msg>
<status status="FAIL" starttime="20220212 11:30:11.982" endtime="20220212 11:30:11.983"></status>
</kw>
<tags>
<tag>bug-0004</tag>
</tags>
<status status="FAIL" starttime="20220212 11:30:11.971" endtime="20220212 11:30:11.983" critical="yes">422 is not one of [502]

Failed validating 'enum' in schema:
    {'enum': [502], 'type': 'integer'}

On instance:
    422</status>
</test>
<test id="s1-t6" name="fetch, 422, Empty ids">
<kw name="Get Body">
<assign>
<var>${body}</var>
</assign>
<kw name="Copy Dictionary" library="Collections">
<doc>Returns a copy of the given dictionary.</doc>
<arguments>
<arg>${BROKER_BODY}</arg>
<arg>deepcopy=True</arg>
</arguments>
<assign>
<var>${body}</var>
</assign>
<msg timestamp="20220212 11:30:11.985" level="INFO">${body} = {'productCode': 'product-metropolia-assemblin', 'parameters': {'ids': [{'idProperty': 'AI200', 'idRoom': 'A0 PK 12'}], 'dataTypes': ['MeasureAirCO2LevelPPM', 'MeasureAirTemperatureCelsiusDegree', 'Mea...</msg>
<status status="PASS" starttime="20220212 11:30:11.984" endtime="20220212 11:30:11.985"></status>
</kw>
<kw name="Get Current Date" library="DateTime">
<doc>Returns current local or UTC time with an optional increment.</doc>
<arguments>
<arg>time_zone=UTC</arg>
<arg>result_format=%Y-%m-%dT%H:%M:%S+00:00</arg>
</arguments>
<assign>
<var>${now}</var>
</assign>
<msg timestamp="20220212 11:30:11.985" level="INFO">${now} = 2022-02-12T09:30:11+00:00</msg>
<status status="PASS" starttime="20220212 11:30:11.985" endtime="20220212 11:30:11.985"></status>
</kw>
<kw name="Set To Dictionary" library="Collections">
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<arguments>
<arg>${body}</arg>
<arg>timestamp</arg>
<arg>${now}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.985" endtime="20220212 11:30:11.985"></status>
</kw>
<kw name="Set To Dictionary" library="Collections">
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<arguments>
<arg>${body}</arg>
<arg>&amp;{kwargs}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.985" endtime="20220212 11:30:11.985"></status>
</kw>
<kw name="Evaluate" library="BuiltIn">
<doc>Evaluates the given expression in Python and returns the result.</doc>
<arguments>
<arg>json.dumps(${body})</arg>
<arg>json</arg>
</arguments>
<assign>
<var>${json_string}</var>
</assign>
<msg timestamp="20220212 11:30:11.986" level="INFO">${json_string} = {"productCode": "product-metropolia-assemblin", "parameters": {"ids": [{"idProperty": "AI200", "idRoom": "A0 PK 12"}], "dataTypes": ["MeasureAirCO2LevelPPM", "MeasureAirTemperatureCelsiusDegree", "Mea...</msg>
<status status="PASS" starttime="20220212 11:30:11.986" endtime="20220212 11:30:11.986"></status>
</kw>
<msg timestamp="20220212 11:30:11.986" level="INFO">${body} = {'productCode': 'product-metropolia-assemblin', 'parameters': {'ids': [{'idProperty': 'AI200', 'idRoom': 'A0 PK 12'}], 'dataTypes': ['MeasureAirCO2LevelPPM', 'MeasureAirTemperatureCelsiusDegree', 'Mea...</msg>
<status status="PASS" starttime="20220212 11:30:11.984" endtime="20220212 11:30:11.986"></status>
</kw>
<kw name="Set To Dictionary" library="Collections">
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<arguments>
<arg>${body["parameters"]}</arg>
<arg>ids=@{EMPTY}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.986" endtime="20220212 11:30:11.987"></status>
</kw>
<kw name="Fetch Data Product">
<arguments>
<arg>${body}</arg>
</arguments>
<kw name="Calculate Pot Signature" library="PoTLib">
<arguments>
<arg>${body}</arg>
<arg>${CLIENT_SECRET}</arg>
</arguments>
<assign>
<var>${signature}</var>
</assign>
<msg timestamp="20220212 11:30:11.988" level="INFO">${signature} = patF18Zddh/hFIPQpZVfynOvHV4dm+yzMnRVbFI4aAU=</msg>
<status status="PASS" starttime="20220212 11:30:11.987" endtime="20220212 11:30:11.988"></status>
</kw>
<kw name="Log" library="BuiltIn">
<doc>Logs the given message with the given level.</doc>
<arguments>
<arg>${signature}</arg>
</arguments>
<msg timestamp="20220212 11:30:11.988" level="INFO">patF18Zddh/hFIPQpZVfynOvHV4dm+yzMnRVbFI4aAU=</msg>
<status status="PASS" starttime="20220212 11:30:11.988" endtime="20220212 11:30:11.988"></status>
</kw>
<kw name="Set Headers" library="REST">
<tags>
<tag>settings</tag>
</tags>
<doc>*Sets new request headers or updates the existing.*</doc>
<arguments>
<arg>{"x-pot-signature": "${signature}", "x-app-token": "${APP_TOKEN}"}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.988" endtime="20220212 11:30:11.989"></status>
</kw>
<kw name="Post" library="REST">
<tags>
<tag>http</tag>
</tags>
<doc>*Sends a POST request to the endpoint.*</doc>
<arguments>
<arg>${CONNECTOR_PATH}</arg>
<arg>${body}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.989" endtime="20220212 11:30:11.993"></status>
</kw>
<kw name="Output Schema" library="REST">
<tags>
<tag>I/O</tag>
</tags>
<doc>*Outputs JSON Schema to terminal or a file.*</doc>
<arguments>
<arg>response body</arg>
</arguments>
<msg timestamp="20220212 11:30:11.994" level="INFO">
{
    "type": "object",
    "properties": {
        "error": {
            "type": "object",
            "properties": {
                "status": {
                    "type": "integer",
                    "default": 422
                },
                "message": {
                    "type": "object",
                    "properties": {
                        "parameters.ids[0].idRoom": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            },
                            "default": [
                                "Missing data for required field."
                            ]
                        },
                        "parameters.ids[0].idProperty": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            },
                            "default": [
                                "Missing data for required field."
                            ]
                        }
                    },
                    "required": [
                        "parameters.ids[0].idProperty",
                        "parameters.ids[0].idRoom"
                    ]
                }
            },
            "required": [
                "message",
                "status"
            ]
        }
    },
    "required": [
        "error"
    ]
}</msg>
<status status="PASS" starttime="20220212 11:30:11.994" endtime="20220212 11:30:11.995"></status>
</kw>
<status status="PASS" starttime="20220212 11:30:11.987" endtime="20220212 11:30:11.995"></status>
</kw>
<kw name="Integer" library="REST">
<tags>
<tag>assertions</tag>
</tags>
<doc>*Asserts the field as JSON integer.*</doc>
<arguments>
<arg>response status</arg>
<arg>502</arg>
</arguments>
<msg timestamp="20220212 11:30:11.996" level="FAIL">422 is not one of [502]

Failed validating 'enum' in schema:
    {'enum': [502], 'type': 'integer'}

On instance:
    422</msg>
<status status="FAIL" starttime="20220212 11:30:11.995" endtime="20220212 11:30:11.996"></status>
</kw>
<tags>
<tag>bug-0005</tag>
</tags>
<status status="FAIL" starttime="20220212 11:30:11.984" endtime="20220212 11:30:11.996" critical="yes">422 is not one of [502]

Failed validating 'enum' in schema:
    {'enum': [502], 'type': 'integer'}

On instance:
    422</status>
</test>
<test id="s1-t7" name="fetch, 422, Empty dataTypes">
<kw name="Get Body">
<assign>
<var>${body}</var>
</assign>
<kw name="Copy Dictionary" library="Collections">
<doc>Returns a copy of the given dictionary.</doc>
<arguments>
<arg>${BROKER_BODY}</arg>
<arg>deepcopy=True</arg>
</arguments>
<assign>
<var>${body}</var>
</assign>
<msg timestamp="20220212 11:30:11.997" level="INFO">${body} = {'productCode': 'product-metropolia-assemblin', 'parameters': {'ids': [{'idProperty': 'AI200', 'idRoom': 'A0 PK 12'}], 'dataTypes': ['MeasureAirCO2LevelPPM', 'MeasureAirTemperatureCelsiusDegree', 'Mea...</msg>
<status status="PASS" starttime="20220212 11:30:11.997" endtime="20220212 11:30:11.997"></status>
</kw>
<kw name="Get Current Date" library="DateTime">
<doc>Returns current local or UTC time with an optional increment.</doc>
<arguments>
<arg>time_zone=UTC</arg>
<arg>result_format=%Y-%m-%dT%H:%M:%S+00:00</arg>
</arguments>
<assign>
<var>${now}</var>
</assign>
<msg timestamp="20220212 11:30:11.997" level="INFO">${now} = 2022-02-12T09:30:11+00:00</msg>
<status status="PASS" starttime="20220212 11:30:11.997" endtime="20220212 11:30:11.997"></status>
</kw>
<kw name="Set To Dictionary" library="Collections">
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<arguments>
<arg>${body}</arg>
<arg>timestamp</arg>
<arg>${now}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.997" endtime="20220212 11:30:11.998"></status>
</kw>
<kw name="Set To Dictionary" library="Collections">
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<arguments>
<arg>${body}</arg>
<arg>&amp;{kwargs}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.998" endtime="20220212 11:30:11.998"></status>
</kw>
<kw name="Evaluate" library="BuiltIn">
<doc>Evaluates the given expression in Python and returns the result.</doc>
<arguments>
<arg>json.dumps(${body})</arg>
<arg>json</arg>
</arguments>
<assign>
<var>${json_string}</var>
</assign>
<msg timestamp="20220212 11:30:11.998" level="INFO">${json_string} = {"productCode": "product-metropolia-assemblin", "parameters": {"ids": [{"idProperty": "AI200", "idRoom": "A0 PK 12"}], "dataTypes": ["MeasureAirCO2LevelPPM", "MeasureAirTemperatureCelsiusDegree", "Mea...</msg>
<status status="PASS" starttime="20220212 11:30:11.998" endtime="20220212 11:30:11.998"></status>
</kw>
<msg timestamp="20220212 11:30:11.999" level="INFO">${body} = {'productCode': 'product-metropolia-assemblin', 'parameters': {'ids': [{'idProperty': 'AI200', 'idRoom': 'A0 PK 12'}], 'dataTypes': ['MeasureAirCO2LevelPPM', 'MeasureAirTemperatureCelsiusDegree', 'Mea...</msg>
<status status="PASS" starttime="20220212 11:30:11.996" endtime="20220212 11:30:11.999"></status>
</kw>
<kw name="Set To Dictionary" library="Collections">
<doc>Adds the given ``key_value_pairs`` and ``items`` to the ``dictionary``.</doc>
<arguments>
<arg>${body["parameters"]}</arg>
<arg>dataTypes=@{EMPTY}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:11.999" endtime="20220212 11:30:11.999"></status>
</kw>
<kw name="Fetch Data Product">
<arguments>
<arg>${body}</arg>
</arguments>
<kw name="Calculate Pot Signature" library="PoTLib">
<arguments>
<arg>${body}</arg>
<arg>${CLIENT_SECRET}</arg>
</arguments>
<assign>
<var>${signature}</var>
</assign>
<msg timestamp="20220212 11:30:12.000" level="INFO">${signature} = jRvbqb+M2ElB/ezrGZxKD8qkfIujLNrF3FSmoJMZi2Y=</msg>
<status status="PASS" starttime="20220212 11:30:12.000" endtime="20220212 11:30:12.000"></status>
</kw>
<kw name="Log" library="BuiltIn">
<doc>Logs the given message with the given level.</doc>
<arguments>
<arg>${signature}</arg>
</arguments>
<msg timestamp="20220212 11:30:12.001" level="INFO">jRvbqb+M2ElB/ezrGZxKD8qkfIujLNrF3FSmoJMZi2Y=</msg>
<status status="PASS" starttime="20220212 11:30:12.001" endtime="20220212 11:30:12.001"></status>
</kw>
<kw name="Set Headers" library="REST">
<tags>
<tag>settings</tag>
</tags>
<doc>*Sets new request headers or updates the existing.*</doc>
<arguments>
<arg>{"x-pot-signature": "${signature}", "x-app-token": "${APP_TOKEN}"}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:12.001" endtime="20220212 11:30:12.001"></status>
</kw>
<kw name="Post" library="REST">
<tags>
<tag>http</tag>
</tags>
<doc>*Sends a POST request to the endpoint.*</doc>
<arguments>
<arg>${CONNECTOR_PATH}</arg>
<arg>${body}</arg>
</arguments>
<status status="PASS" starttime="20220212 11:30:12.001" endtime="20220212 11:30:33.736"></status>
</kw>
<kw name="Output Schema" library="REST">
<tags>
<tag>I/O</tag>
</tags>
<doc>*Outputs JSON Schema to terminal or a file.*</doc>
<arguments>
<arg>response body</arg>
</arguments>
<msg timestamp="20220212 11:30:33.736" level="INFO">
{
    "type": "object",
    "properties": {
        "@context": {
            "type": "string",
            "default": "https://standards.oftrust.net/v2/Context/DataProductContext/Sensor/"
        },
        "data": {
            "type": "object",
            "properties": {
                "sensors": {
                    "type": "array",
                    "default": []
                }
            },
            "required": [
                "sensors"
            ]
        },
        "signature": {
            "type": "object",
            "properties": {
                "type": {
                    "type": "string",
                    "default": "RsaSignature2018"
                },
                "created": {
                    "type": "string",
                    "default": "2022-02-12T11:30:33+02:00"
                },
                "creator": {
                    "type": "string",
                    "default": "https://localhost:8080/assemblin/translator/v1/public.key"
                },
                "signatureValue": {
                    "type": "string",
                    "default": "uEp6HqJ/xsj9mvSvmCM4XhUrpSsCYsUFFXEaNDQ7zXCkX3TZxbwHnwHob9ioXeqe4fWN8tMj0h3AkxcLaAstDW/gnd4ThtJted/ZxrT5Uaja9wG+SdcxpFjwZDdifeb5OyS0+09OydLpfhpWsEhqHz/6ask8i6lViAXKyjm3jkbmRB8yXOqMCo57fOo6tY1irCgP3hE2G+2ztHJDyE4lk/aTipURhX3j8QAAoCoT55CcHTO2D786lwfwGqhWP13GauIYeS92+52Tp/GT3NXDIB7k93llbrkVXM41Lyg3WiDNJ49wbgdf3bOUKRvrMxqIvaKhoCIl/LQbAA3O1dRe14FNEtiVLituGyNaueSlkPFCQ36Mq6B1B3eGuaN3rIhDRsgYiCq77L0SC6SYJFGBu48TSK07zhxm79f1Xtedv+IaHYT4wVlZkiOaajgbhwZDDDiJx+Eb8NWqoZJF1fb/MBd1tSIkg62yGg803WlIWjLVgy/sHleWEWxmiyM63xX2RMN63dL1e8AwKhOfl5Z2QuDEn0iIEjNGSnb83uI2q1Gz23PcWlXdd3s6PMrwXHdbPiiASMbPqIpzltg7UGIcQRy2fGLD8bGaSTa082Kok3d24bj6nvnW0hGO/3yWsDcV7ZsITqFoU9V8UNCQ7reZRN1dSNyPWf6zXjd0OfDxbwQ="
                }
            },
            "required": [
                "created",
                "creator",
                "signatureValue",
                "type"
            ]
        }
    },
    "required": [
        "@context",
        "data",
        "signature"
    ]
}</msg>
<status status="PASS" starttime="20220212 11:30:33.736" endtime="20220212 11:30:33.737"></status>
</kw>
<status status="PASS" starttime="20220212 11:30:12.000" endtime="20220212 11:30:33.737"></status>
</kw>
<kw name="Integer" library="REST">
<tags>
<tag>assertions</tag>
</tags>
<doc>*Asserts the field as JSON integer.*</doc>
<arguments>
<arg>response status</arg>
<arg>502</arg>
</arguments>
<msg timestamp="20220212 11:30:33.738" level="FAIL">200 is not one of [502]

Failed validating 'enum' in schema:
    {'enum': [502], 'type': 'integer'}

On instance:
    200</msg>
<status status="FAIL" starttime="20220212 11:30:33.738" endtime="20220212 11:30:33.739"></status>
</kw>
<tags>
<tag>bug-0006</tag>
</tags>
<status status="FAIL" starttime="20220212 11:30:11.996" endtime="20220212 11:30:33.739" critical="yes">200 is not one of [502]

Failed validating 'enum' in schema:
    {'enum': [502], 'type': 'integer'}

On instance:
    200</status>
</test>
<doc>Assemblin Temperature / CO2 sensors</doc>
<status status="FAIL" starttime="20220212 11:29:28.920" endtime="20220212 11:30:33.740"></status>
</suite>
<statistics>
<total>
<stat pass="1" fail="6">Critical Tests</stat>
<stat pass="1" fail="6">All Tests</stat>
</total>
<tag>
<stat pass="1" fail="1">bug-0001</stat>
<stat pass="0" fail="1">bug-0002</stat>
<stat pass="0" fail="1">bug-0003</stat>
<stat pass="0" fail="1">bug-0004</stat>
<stat pass="0" fail="1">bug-0005</stat>
<stat pass="0" fail="1">bug-0006</stat>
</tag>
<suite>
<stat pass="1" fail="6" id="s1" name="Connector Tests">Connector Tests</stat>
</suite>
</statistics>
<errors>
</errors>
</robot>
